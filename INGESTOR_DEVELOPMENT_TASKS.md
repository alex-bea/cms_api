# Ingestor Development Tasks & Priority Matrix

## üéØ **Current Status Overview**

### ‚úÖ **Completed Ingestors (3/12)**
- **RVU Ingestor** - Fully DIS-compliant, tested, production-ready
- **CMS ZIP9 Ingester** - Fully DIS-compliant, tested, production-ready  
- **CMS ZIP Locality Production Ingester** - Production-ready with observability

### ‚ùå **Missing Ingestors (9/12)**
- **MPFS Ingester** - Referenced but doesn't exist (broken imports)
- **OPPS Ingester** - Referenced but doesn't exist (broken imports)
- **ASC Ingester** - Not implemented
- **IPPS Ingester** - Not implemented
- **CLFS Ingester** - Not implemented
- **DMEPOS Ingester** - Not implemented
- **ASP Ingester** - Not implemented
- **NADAC Ingester** - Not implemented
- **Reference Data Ingestors** - Not implemented

---

## üìã **Priority Matrix & Implementation Tasks**

### üî¥ **Phase 1: Critical Core CMS Ingestors (2-3 weeks)**

#### **Task 1: MPFS Ingester** 
- **Priority**: üî¥ Critical
- **Complexity**: Medium
- **Dependencies**: None
- **Estimated Time**: 3-4 days
- **Status**: ‚ùå Missing (broken imports across codebase)

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/mpfs_ingestor.py`
- [ ] Implement DIS-compliant MPFS ingester following RVU ingester pattern
- [ ] Handle MPFS RVU data, conversion factors, and fee schedule data
- [ ] Support both annual and quarterly correction releases
- [ ] Add schema contracts for MPFS data validation
- [ ] Implement 5-pillar observability (Freshness, Volume, Schema, Quality, Lineage)
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards
- [ ] Fix all broken imports across codebase
- [ ] Update documentation to reflect actual status

**Files to Create/Modify:**
- `cms_pricing/ingestion/ingestors/mpfs_ingestor.py` (new)
- `cms_pricing/ingestion/contracts/cms_mpfs_v1.0.json` (new)
- `tests/integration/test_mpfs_ingestor_e2e.py` (new)
- `tests/fixtures/mpfs/` (new test data)
- Fix imports in: `examples/ingestion_example.py`, `scripts/ingest_all.py`, `cms_pricing/cli.py`, `cms_pricing/worker.py`

**DIS Compliance Checklist:**
- [ ] Land stage: Download and store raw files with manifest
- [ ] Validate stage: Structural, domain, and statistical validation
- [ ] Normalize stage: Canonicalize column names and data types
- [ ] Enrich stage: Join with reference data (GPCI, localities)
- [ ] Publish stage: Store in curated format with metadata
- [ ] Schema Registry integration
- [ ] Quarantine zone for rejects
- [ ] Reference data integration
- [ ] Idempotent upserts
- [ ] Schema drift detection

---

#### **Task 2: OPPS Ingester**
- **Priority**: üî¥ Critical  
- **Complexity**: Medium
- **Dependencies**: None
- **Estimated Time**: 3-4 days
- **Status**: ‚ùå Missing (broken imports across codebase)

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/opps_ingestor.py`
- [ ] Implement DIS-compliant OPPS ingester
- [ ] Handle APC payment rates and HCPCS to APC mapping
- [ ] Support quarterly releases (Q1-Q4)
- [ ] Add schema contracts for OPPS data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards
- [ ] Fix all broken imports across codebase

**Files to Create/Modify:**
- `cms_pricing/ingestion/ingestors/opps_ingestor.py` (new)
- `cms_pricing/ingestion/contracts/cms_opps_v1.0.json` (new)
- `tests/integration/test_opps_ingestor_e2e.py` (new)
- `tests/fixtures/opps/` (new test data)
- Fix imports in: `examples/ingestion_example.py`, `scripts/ingest_all.py`, `cms_pricing/cli.py`, `cms_pricing/worker.py`

---

#### **Task 3: ASC Ingester**
- **Priority**: üü° High
- **Complexity**: Low
- **Dependencies**: None
- **Estimated Time**: 2-3 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/asc_ingestor.py`
- [ ] Implement DIS-compliant ASC ingester
- [ ] Handle Ambulatory Surgical Center fee schedule data
- [ ] Support quarterly releases
- [ ] Add schema contracts for ASC data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

**Files to Create/Modify:**
- `cms_pricing/ingestion/ingestors/asc_ingestor.py` (new)
- `cms_pricing/ingestion/contracts/cms_asc_v1.0.json` (new)
- `tests/integration/test_asc_ingestor_e2e.py` (new)
- `tests/fixtures/asc/` (new test data)

---

### üü° **Phase 2: Supporting CMS Ingestors (2-3 weeks)**

#### **Task 4: CLFS Ingester**
- **Priority**: üü° High
- **Complexity**: Low
- **Dependencies**: None
- **Estimated Time**: 2-3 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/clfs_ingestor.py`
- [ ] Implement DIS-compliant CLFS ingester
- [ ] Handle Clinical Laboratory Fee Schedule data
- [ ] Support quarterly releases
- [ ] Add schema contracts for CLFS data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

---

#### **Task 5: DMEPOS Ingester**
- **Priority**: üü° High
- **Complexity**: Medium
- **Dependencies**: Geography data
- **Estimated Time**: 3-4 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/dmepos_ingestor.py`
- [ ] Implement DIS-compliant DMEPOS ingester
- [ ] Handle Durable Medical Equipment pricing data
- [ ] Support quarterly releases
- [ ] Add schema contracts for DMEPOS data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards
- [ ] Integrate with geography data for rural adjustments

---

#### **Task 6: ASP Ingester**
- **Priority**: üü° High
- **Complexity**: Low
- **Dependencies**: None
- **Estimated Time**: 2-3 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/asp_ingestor.py`
- [ ] Implement DIS-compliant ASP ingester
- [ ] Handle Average Sales Price data for Part B drugs
- [ ] Support quarterly releases
- [ ] Add schema contracts for ASP data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

---

#### **Task 7: IPPS Ingester**
- **Priority**: üü° High
- **Complexity**: Medium
- **Dependencies**: None
- **Estimated Time**: 3-4 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/ipps_ingestor.py`
- [ ] Implement DIS-compliant IPPS ingester
- [ ] Handle Inpatient Prospective Payment System data
- [ ] Support annual releases (FY)
- [ ] Add schema contracts for IPPS data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

---

### üü¢ **Phase 3: Reference Data Ingestors (1-2 weeks)**

#### **Task 8: Census Geography Ingester**
- **Priority**: üü° High
- **Complexity**: Medium
- **Dependencies**: None
- **Estimated Time**: 3-4 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/census_geography_ingestor.py`
- [ ] Implement DIS-compliant Census geography ingester
- [ ] Handle ZCTA, Gazetteer, FIPS codes
- [ ] Support annual releases
- [ ] Add schema contracts for Census data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

---

#### **Task 9: HRSA Ingester**
- **Priority**: üü¢ Medium
- **Complexity**: Low
- **Dependencies**: Geography data
- **Estimated Time**: 2-3 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/hrsa_ingestor.py`
- [ ] Implement DIS-compliant HRSA ingester
- [ ] Handle HPSA, MUA/P, NHSC sites data
- [ ] Support monthly releases
- [ ] Add schema contracts for HRSA data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards
- [ ] Integrate with geography data for geocoding

---

#### **Task 10: NBER Distance Ingester**
- **Priority**: üü¢ Medium
- **Complexity**: Low
- **Dependencies**: Geography data
- **Estimated Time**: 1-2 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/nber_distance_ingestor.py`
- [ ] Implement DIS-compliant NBER distance ingester
- [ ] Handle precomputed ZIP-to-ZIP distances
- [ ] Support ad-hoc releases (static data)
- [ ] Add schema contracts for NBER data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards
- [ ] Integrate with geography data for validation

---

#### **Task 11: NADAC Ingester**
- **Priority**: üü¢ Medium
- **Complexity**: Low
- **Dependencies**: None
- **Estimated Time**: 2-3 days
- **Status**: ‚ùå Not implemented

**Requirements:**
- [ ] Create `cms_pricing/ingestion/ingestors/nadac_ingestor.py`
- [ ] Implement DIS-compliant NADAC ingester
- [ ] Handle National Average Drug Acquisition Cost data
- [ ] Support weekly releases
- [ ] Add schema contracts for NADAC data validation
- [ ] Implement 5-pillar observability
- [ ] Add quarantine workflow for rejected records
- [ ] Create comprehensive test suite following QTS standards

---

## üèóÔ∏è **Implementation Standards**

### **DIS Compliance Requirements**
Each ingester must implement:

1. **Land Stage**: Download and store raw files with manifest
2. **Validate Stage**: Structural, domain, and statistical validation
3. **Normalize Stage**: Canonicalize column names and data types
4. **Enrich Stage**: Join with reference data
5. **Publish Stage**: Store in curated format with metadata

### **Technical Requirements**
- [ ] Schema Registry integration
- [ ] Quarantine zone for rejects
- [ ] Reference data integration
- [ ] Idempotent upserts
- [ ] Schema drift detection
- [ ] 5-pillar observability (Freshness, Volume, Schema, Quality, Lineage)
- [ ] Comprehensive test suite following QTS standards
- [ ] API integration following Global API Program standards

### **File Structure**
```
cms_pricing/ingestion/ingestors/
‚îú‚îÄ‚îÄ mpfs_ingestor.py          # Task 1
‚îú‚îÄ‚îÄ opps_ingestor.py          # Task 2
‚îú‚îÄ‚îÄ asc_ingestor.py           # Task 3
‚îú‚îÄ‚îÄ clfs_ingestor.py          # Task 4
‚îú‚îÄ‚îÄ dmepos_ingestor.py        # Task 5
‚îú‚îÄ‚îÄ asp_ingestor.py           # Task 6
‚îú‚îÄ‚îÄ ipps_ingestor.py          # Task 7
‚îú‚îÄ‚îÄ census_geography_ingestor.py  # Task 8
‚îú‚îÄ‚îÄ hrsa_ingestor.py          # Task 9
‚îú‚îÄ‚îÄ nber_distance_ingestor.py # Task 10
‚îî‚îÄ‚îÄ nadac_ingestor.py         # Task 11
```

### **Test Structure**
```
tests/integration/
‚îú‚îÄ‚îÄ test_mpfs_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_opps_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_asc_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_clfs_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_dmepos_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_asp_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_ipps_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_census_geography_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_hrsa_ingestor_e2e.py
‚îú‚îÄ‚îÄ test_nber_distance_ingestor_e2e.py
‚îî‚îÄ‚îÄ test_nadac_ingestor_e2e.py
```

---

## üéØ **Next Steps**

1. **Start with Task 1: MPFS Ingester** - Most critical and has broken imports
2. **Follow DIS standards** - Use RVU ingester as template
3. **Implement comprehensive testing** - Follow QTS standards
4. **Update documentation** - Fix misleading status claims
5. **Fix broken imports** - Update all references across codebase

---

## üìä **Progress Tracking**

| Task | Status | Priority | Est. Time | Dependencies | Assigned |
|------|--------|----------|-----------|--------------|----------|
| 1. MPFS Ingester | ‚ùå Not Started | üî¥ Critical | 3-4 days | None | - |
| 2. OPPS Ingester | ‚ùå Not Started | üî¥ Critical | 3-4 days | None | - |
| 3. ASC Ingester | ‚ùå Not Started | üü° High | 2-3 days | None | - |
| 4. CLFS Ingester | ‚ùå Not Started | üü° High | 2-3 days | None | - |
| 5. DMEPOS Ingester | ‚ùå Not Started | üü° High | 3-4 days | Geography | - |
| 6. ASP Ingester | ‚ùå Not Started | üü° High | 2-3 days | None | - |
| 7. IPPS Ingester | ‚ùå Not Started | üü° High | 3-4 days | None | - |
| 8. Census Geography | ‚ùå Not Started | üü° High | 3-4 days | None | - |
| 9. HRSA Ingester | ‚ùå Not Started | üü¢ Medium | 2-3 days | Geography | - |
| 10. NBER Distance | ‚ùå Not Started | üü¢ Medium | 1-2 days | Geography | - |
| 11. NADAC Ingester | ‚ùå Not Started | üü¢ Medium | 2-3 days | None | - |

**Total Estimated Time**: 4-6 weeks
**Current Completion**: 3/12 ingestors (25%)
