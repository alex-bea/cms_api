{
  "dataset_name": "cms_conversion_factor",
  "version": "2.0",
  "generated_at": "2025-10-15T00:00:00Z",
  "hash_spec_version": "1",
  "natural_keys": [
    "cf_type",
    "effective_from"
  ],
  "column_order": [
    "cf_type",
    "cf_value",
    "cf_description",
    "effective_from"
  ],
  "hash_metadata_exclusions": [
    "release_id",
    "vintage_date",
    "product_year",
    "quarter_vintage",
    "source_filename",
    "source_file_sha256",
    "source_uri",
    "parsed_at",
    "row_content_hash",
    "effective_to",
    "source_url"
  ],
  "description": "CMS MPFS Conversion Factor schema (physician and anesthesia)",
  "source": {
    "url": "https://www.cms.gov/medicare/payment/fee-schedules/physician",
    "update_frequency": "Annual",
    "authority": "CMS Final Rule",
    "documentation": "https://www.cms.gov/newsroom/press-releases/hhs-finalizes-physician-payment-rule-strengthening-person-centered-care-and-health-quality-measures"
  },
  "columns": {
    "cf_type": {
      "name": "cf_type",
      "type": "str",
      "nullable": false,
      "description": "Conversion factor type (physician or anesthesia)",
      "unit": null,
      "domain": [
        "physician",
        "anesthesia"
      ],
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "sample_values": [
        "physician",
        "anesthesia"
      ]
    },
    "cf_value": {
      "name": "cf_value",
      "type": "float64",
      "precision": 4,
      "scale": 4,
      "rounding_mode": "HALF_UP",
      "multipleOf": 0.0001,
      "nullable": false,
      "description": "Conversion factor value in USD",
      "unit": "USD",
      "domain": null,
      "min_value": 0.0,
      "max_value": 100.0,
      "pattern": null,
      "sample_values": [
        32.3465,
        19.31
      ]
    },
    "cf_description": {
      "name": "cf_description",
      "type": "str",
      "nullable": true,
      "description": "Description or notes about this conversion factor",
      "unit": null,
      "domain": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "sample_values": [
        "CY 2025 Physician Fee Schedule",
        "CY 2025 Anesthesia Base Unit"
      ]
    },
    "effective_from": {
      "name": "effective_from",
      "type": "datetime64[ns]",
      "nullable": false,
      "description": "Effective start date",
      "unit": null,
      "domain": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "sample_values": [
        "2025-01-01"
      ]
    },
    "effective_to": {
      "name": "effective_to",
      "type": "datetime64[ns]",
      "nullable": true,
      "description": "Effective end date (null if currently active)",
      "unit": null,
      "domain": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "sample_values": [
        null,
        "2025-12-31"
      ]
    },
    "row_content_hash": {
      "name": "row_content_hash",
      "type": "str",
      "nullable": false,
      "description": "64-character SHA-256 hex digest of row content per STD-parser-contracts v1.1 \u00a75.2. Computed from columns in declared order excluding metadata fields. Uses schema-defined precision for numeric normalization.",
      "unit": null,
      "domain": null,
      "min_value": null,
      "max_value": null,
      "pattern": "^[a-f0-9]{64}$",
      "sample_values": [
        "a1b2c3d4e5f6789012345678901234567890123456789012345678901234"
      ]
    }
  },
  "primary_keys": [
    "cf_type",
    "effective_from"
  ],
  "partition_columns": [],
  "business_rules": [
    "Physician conversion factor must be present for each calendar year",
    "Anesthesia conversion factor must be present for each calendar year",
    "CF values must be positive (> 0)",
    "Effective dates must not overlap for same cf_type",
    "Physician CF typically ranges from 30-40 USD (as of 2020-2025)",
    "Anesthesia CF typically ranges from 15-25 USD (as of 2020-2025)",
    "Physician and anesthesia CFs must be tracked separately (different tables or cf_type field)"
  ],
  "quality_thresholds": {
    "completeness": 1.0,
    "uniqueness_pk": 1.0,
    "validity_cf_value": 1.0,
    "validity_effective_from": 1.0,
    "null_rate_threshold": 0.0,
    "duplicate_rate_threshold": 0.0
  },
  "validation_rules": {
    "cf_type_domain": {
      "rule": "cf_type must be 'physician' or 'anesthesia'",
      "severity": "BLOCK",
      "enforcement": "Pre-normalization"
    },
    "cf_value_positive": {
      "rule": "cf_value must be greater than 0",
      "severity": "BLOCK",
      "enforcement": "Domain validation"
    },
    "cf_value_range": {
      "rule": "cf_value should be between 0 and 100",
      "severity": "WARN",
      "enforcement": "Statistical validation"
    },
    "effective_from_required": {
      "rule": "effective_from must be present",
      "severity": "BLOCK",
      "enforcement": "Pre-normalization"
    },
    "no_overlapping_dates": {
      "rule": "Effective date ranges must not overlap for same cf_type",
      "severity": "BLOCK",
      "enforcement": "Referential validation"
    },
    "annual_completeness": {
      "rule": "Both physician and anesthesia CFs must exist for each year",
      "severity": "WARN",
      "enforcement": "Post-ingestion validation"
    }
  },
  "storage_note": "Stored as float64 in Parquet for efficiency. Canonicalized to Decimal with schema-defined precision before hashing to ensure determinism.",
  "metadata": {
    "created_by": "CMS API Data Engineering",
    "created_at": "2025-10-15",
    "prd_reference": "PRD-mpfs-prd-v1.0.md",
    "compliance": "DIS v1.0, STD-parser-contracts v1.1",
    "notes": "Physician CF and Anesthesia CF must be tracked separately. Physician CF is national (applies to all localities). Anesthesia CF varies by locality but is also tracked here for the base/national rate. Vintage tracking uses metadata fields (product_year, quarter_vintage) not data columns."
  },
  "changelog": [
    {
      "version": "2.0",
      "date": "2025-10-15",
      "breaking_changes": [
        "REMOVED vintage_year column (duplicates metadata fields product_year/quarter_vintage per STD-parser-contracts v1.1 \u00a76.4)",
        "REMOVED vintage_year_format validation rule (no longer applicable)"
      ],
      "migration": {
        "from_version": "1.0",
        "steps": [
          "Remove vintage_year from all queries and mappings",
          "Use product_year or quarter_vintage metadata columns instead",
          "Re-ingest existing data with new schema to populate metadata fields",
          "Update any downstream consumers expecting vintage_year column"
        ],
        "impact": "Breaking change for consumers reading vintage_year. Metadata fields provide equivalent information."
      },
      "changes": [
        "Added precision (4dp), rounding_mode (HALF_UP), scale, multipleOf to cf_value for hash stability",
        "Updated row_content_hash pattern from 16-char to 64-char SHA-256 digest",
        "Added hash_spec_version, column_order, hash_metadata_exclusions for deterministic hashing",
        "Removed partition_columns (vintage_year removed)",
        "Added storage_note explaining Parquet/Decimal canonicalization"
      ]
    },
    {
      "version": "1.0",
      "date": "2025-10-15",
      "changes": [
        "Initial conversion factor schema contract"
      ]
    }
  ]
}