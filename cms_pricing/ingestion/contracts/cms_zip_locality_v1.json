{
  "dataset_name": "cms_zip_locality",
  "version": "1.1",
  "generated_at": "2025-09-30T03:30:00Z",
  "hash_spec_version": "1",
  "natural_keys": [
    "zip_code",
    "effective_from"
  ],
  "schema_type": "json_schema",
  "description": "CMS ZIP Code Carrier Locality mapping with full DIS compliance",
  "classification": "public",
  "license": "CMS Public Domain",
  "source_url": "https://www.cms.gov/files/zip/zip-code-carrier-locality-file-revised-08/14/2025.zip",
  "business_owner": "CMS Pricing Team",
  "data_steward": "Data Engineering",
  "columns": {
    "zip5": {
      "name": "zip5",
      "type": "string",
      "format": "zip5",
      "nullable": false,
      "description": "5-digit ZIP code",
      "pattern": "^\\d{5}$",
      "min_length": 5,
      "max_length": 5,
      "business_glossary": "US Postal Service 5-digit ZIP code",
      "pii_classification": "none",
      "domain_values": null,
      "validation_rules": [
        "required",
        "zip5_format",
        "unique_within_release"
      ]
    },
    "state": {
      "name": "state",
      "type": "string",
      "format": "state_code",
      "nullable": false,
      "description": "2-letter state code",
      "pattern": "^[A-Z]{2}$",
      "min_length": 2,
      "max_length": 2,
      "business_glossary": "US state or territory abbreviation",
      "pii_classification": "none",
      "domain_values": [
        "AL",
        "AK",
        "AZ",
        "AR",
        "CA",
        "CO",
        "CT",
        "DE",
        "FL",
        "GA",
        "HI",
        "ID",
        "IL",
        "IN",
        "IA",
        "KS",
        "KY",
        "LA",
        "ME",
        "MD",
        "MA",
        "MI",
        "MN",
        "MS",
        "MO",
        "MT",
        "NE",
        "NV",
        "NH",
        "NJ",
        "NM",
        "NY",
        "NC",
        "ND",
        "OH",
        "OK",
        "OR",
        "PA",
        "RI",
        "SC",
        "SD",
        "TN",
        "TX",
        "UT",
        "VT",
        "VA",
        "WA",
        "WV",
        "WI",
        "WY",
        "DC",
        "PR",
        "VI",
        "AS",
        "GU",
        "MP"
      ],
      "validation_rules": [
        "required",
        "state_code_format",
        "valid_state_code"
      ]
    },
    "locality": {
      "name": "locality",
      "type": "string",
      "format": "cms_locality",
      "nullable": false,
      "description": "CMS locality code",
      "pattern": "^[0-9]{2,10}$",
      "min_length": 2,
      "max_length": 10,
      "business_glossary": "CMS-defined locality code for pricing",
      "pii_classification": "none",
      "domain_values": null,
      "validation_rules": [
        "required",
        "locality_format",
        "non_empty"
      ]
    },
    "carrier_mac": {
      "name": "carrier_mac",
      "type": "string",
      "format": "cms_mac",
      "nullable": true,
      "description": "Carrier MAC area code",
      "pattern": "^[0-9]{2,10}$",
      "min_length": 2,
      "max_length": 10,
      "business_glossary": "Medicare Administrative Contractor area code",
      "pii_classification": "none",
      "domain_values": null,
      "validation_rules": [
        "optional",
        "mac_format"
      ]
    },
    "rural_flag": {
      "name": "rural_flag",
      "type": "boolean",
      "format": "boolean",
      "nullable": true,
      "description": "Rural area indicator",
      "business_glossary": "Indicates if ZIP code is in a rural area for CMS pricing",
      "pii_classification": "none",
      "domain_values": [
        true,
        false
      ],
      "validation_rules": [
        "optional",
        "boolean_type"
      ]
    },
    "effective_from": {
      "name": "effective_from",
      "type": "string",
      "format": "date",
      "nullable": false,
      "description": "Business validity start date",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "business_glossary": "Date when this mapping becomes effective",
      "pii_classification": "none",
      "validation_rules": [
        "required",
        "date_format",
        "not_future"
      ]
    },
    "effective_to": {
      "name": "effective_to",
      "type": "string",
      "format": "date",
      "nullable": true,
      "description": "Business validity end date",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "business_glossary": "Date when this mapping expires (null = current)",
      "pii_classification": "none",
      "validation_rules": [
        "optional",
        "date_format",
        "after_effective_from"
      ]
    },
    "vintage": {
      "name": "vintage",
      "type": "string",
      "format": "vintage_date",
      "nullable": false,
      "description": "Source release date",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "business_glossary": "Date when this data was published by CMS",
      "pii_classification": "none",
      "validation_rules": [
        "required",
        "date_format",
        "not_future"
      ]
    },
    "source_filename": {
      "name": "source_filename",
      "type": "string",
      "format": "filename",
      "nullable": true,
      "description": "Source file name",
      "business_glossary": "Name of the file this record was extracted from",
      "pii_classification": "none",
      "validation_rules": [
        "optional",
        "filename_format"
      ]
    },
    "ingest_run_id": {
      "name": "ingest_run_id",
      "type": "string",
      "format": "uuid",
      "nullable": true,
      "description": "Ingestion run identifier",
      "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
      "business_glossary": "Unique identifier for the ingestion run that created this record",
      "pii_classification": "none",
      "validation_rules": [
        "optional",
        "uuid_format"
      ]
    },
    "row_content_hash": {
      "name": "row_content_hash",
      "type": "str",
      "nullable": false,
      "description": "64-character SHA-256 hex digest of row content per STD-parser-contracts v1.1 \u00a75.2",
      "pattern": "^[a-f0-9]{64}$"
    }
  },
  "primary_keys": [
    "zip5"
  ],
  "business_keys": [
    "zip5",
    "effective_from"
  ],
  "partition_columns": [
    "state",
    "vintage"
  ],
  "constraints": {
    "unique_zip5_per_release": {
      "type": "unique",
      "columns": [
        "zip5",
        "vintage"
      ],
      "description": "Each ZIP5 can only appear once per vintage"
    },
    "effective_date_range": {
      "type": "check",
      "expression": "effective_to IS NULL OR effective_to >= effective_from",
      "description": "Effective end date must be after start date"
    },
    "state_locality_consistency": {
      "type": "check",
      "expression": "state IS NOT NULL AND locality IS NOT NULL",
      "description": "Both state and locality must be present"
    }
  },
  "quality_thresholds": {
    "completeness": {
      "zip5": 1.0,
      "state": 1.0,
      "locality": 1.0,
      "effective_from": 1.0,
      "vintage": 1.0
    },
    "accuracy": {
      "zip5_format": 1.0,
      "state_code_valid": 1.0,
      "locality_format": 1.0,
      "date_format": 1.0
    },
    "uniqueness": {
      "zip5_per_release": 1.0
    },
    "consistency": {
      "effective_date_range": 1.0,
      "state_locality_present": 1.0
    }
  },
  "business_rules": [
    "ZIP5 codes must be exactly 5 digits",
    "State codes must be valid US state/territory abbreviations",
    "Locality codes must be non-empty numeric strings",
    "Effective dates must be valid and logical",
    "Each ZIP5 can only appear once per vintage",
    "Rural flag is optional but must be boolean when present"
  ],
  "data_lineage": {
    "source": "CMS ZIP Code Carrier Locality File",
    "transformation_steps": [
      "Download from CMS.gov",
      "Extract ZIP files",
      "Parse fixed-width format",
      "Validate data types",
      "Apply business rules",
      "Load to database"
    ],
    "dependencies": [],
    "outputs": [
      "cms_zip_locality table",
      "nearest_zip_resolver API"
    ]
  },
  "sla_requirements": {
    "freshness_hours": 24,
    "availability_percent": 99.9,
    "quality_threshold": 0.95,
    "processing_time_minutes": 30
  },
  "column_order": [
    "zip5",
    "state",
    "locality",
    "carrier_mac",
    "rural_flag",
    "effective_from",
    "ingest_run_id"
  ],
  "hash_metadata_exclusions": [
    "release_id",
    "vintage_date",
    "product_year",
    "quarter_vintage",
    "source_filename",
    "source_file_sha256",
    "source_uri",
    "parsed_at",
    "row_content_hash",
    "effective_to"
  ],
  "changelog": [
    {
      "version": "1.1",
      "date": "2025-10-15",
      "changes": [
        "Updated row_content_hash pattern to 64-char SHA-256 digest",
        "Added hash_spec_version, column_order, hash_metadata_exclusions",
        "Aligned with STD-parser-contracts v1.1"
      ]
    }
  ]
}